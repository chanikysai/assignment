# Setting Up CloudFront Distribution for Secure Access to S3 Files

This guide outlines the steps to configure a CloudFront distribution to securely serve public and private files from an AWS S3 bucket (`acme-downloads`), while meeting specific access control and security requirements.

## Step-by-Step Instructions

### 1. Configure S3 Bucket

- Create an S3 bucket named `acme-downloads`.
- Inside the bucket, create two folders:
  - `public`
  - `private`

### 2. Set Up IAM Policies
IAM Policy for CloudFront:

Create an IAM policy allowing CloudFront to access objects in the acme-downloads bucket. Example policy provided.
``` bash

{
    "Version": "2012-10-17",
    "Statement": [  
        {
            "Effect": "Allow",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::acme-downloads/public/*",
                "arn:aws:s3:::acme-downloads/private/*"
            ]
        }
    ]
}

```


Bucket Policy for S3 Bucket:

Add the provided bucket policy to restrict access to private folder and allow access to public folder.


```bash
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicReadGetObject",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::acme-downloads/public/*"
        },
        {
            "Sid": "PrivateReadDeny",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::acme-downloads/private/*"
        }
    ]
}
```




### 3. Create CloudFront Distribution

- Go to AWS Management Console > CloudFront.
- Click on "Create Distribution".
- Select "Web" distribution type.

#### Origin Settings

- **Origin Domain Name**: `acme-downloads.s3.amazonaws.com`
- **Origin ID**: `S3-acme-downloads`
- **Origin Path**: `/public`
- **Restrict Bucket Access**: Yes
- **Origin Access Identity**: Create a New Identity

#### Default Cache Behavior Settings

- **Viewer Protocol Policy**: Redirect HTTP to HTTPS
- **Allowed HTTP Methods**: GET, HEAD
- **Cached HTTP Methods**: GET, HEAD
- **Query String Forwarding and Caching**: Forward all, cache based on all

#### Create Another Cache Behavior

- **Path Pattern**: `/private/*`
- **Viewer Protocol Policy**: Redirect HTTP to HTTPS
- **Allowed HTTP Methods**: GET, HEAD
- **Cached HTTP Methods**: GET, HEAD
- **Query String Forwarding and Caching**: Forward all, cache based on all
- **Restrict Viewer Access**: Yes
- **Trusted Signers**: Self (if signing URLs programmatically)

### 4. Configure Signed URLs for Private Access

- Use AWS SDK or CLI to generate signed URLs for Rob and Mark.

### 5. Enable Logging

- Enable logging and specify an S3 bucket for storing logs.

### 6. Set Up Email Alerts (Bonus)

- Configure CloudWatch Events to trigger email alerts for downloads from the `/private/` folder.

### 7. Testing and Validation

- Verify access:
  - Public files should be accessible without restrictions via CloudFront.
  - Private files should only be accessible using signed URLs generated by authorized users.
  - Ensure signed URLs for private files do not grant access to public files.

## Screenshots

- Include screenshots of:
  - CloudFront distribution settings.
  - IAM policy configuration.
  - Example of generating a signed URL.
  - CloudWatch Events setup for email alerts.

## Conclusion

By following these steps, you'll have a CloudFront distribution (`acme-cache`) configured to securely serve content from your S3 bucket while meeting all specified requirements. Adjust settings and policies as per your organization's security and access control policies.


![Screenshot](screen.png)
